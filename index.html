<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Cypher - Solana Portfolio Tracker</title>
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Roboto:wght@300;400;500;700&display=swap" rel="stylesheet">
    <script src="https://cdnjs.cloudflare.com/ajax/libs/Chart.js/3.9.1/chart.min.js"></script>
    <style>
        :root {
            --bg-primary: #0A0A0F;
            --bg-secondary: #121218;
            --bg-tertiary: #1A1A23;
            --bg-card: #1E1E2A;
            --bg-glass: rgba(30, 30, 42, 0.8);
            --bg-hover: rgba(99, 102, 241, 0.1);
            
            --accent-primary: #6366F1;
            --accent-secondary: #8B5CF6;
            --accent-tertiary: #06B6D4;
            --accent-pink: #EC4899;
            
            --text-primary: #F8FAFC;
            --text-secondary: #CBD5E1;
            --text-muted: #64748B;
            
            --border-subtle: rgba(248, 250, 252, 0.1);
            --border-primary: rgba(139, 92, 246, 0.3);
            
            --success: #10B981;
            --warning: #F59E0B;
            --error: #EF4444;
            
            --shadow-md: 0 4px 6px -1px rgba(0, 0, 0, 0.2);
            --shadow-lg: 0 10px 15px -3px rgba(0, 0, 0, 0.3);
        }

        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            font-family: 'Roboto', -apple-system, BlinkMacSystemFont, sans-serif;
            background: linear-gradient(135deg, var(--bg-primary) 0%, var(--bg-secondary) 50%, var(--bg-tertiary) 100%);
            color: var(--text-primary);
            min-height: 100vh;
            line-height: 1.6;
        }

        .bg-particles {
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            pointer-events: none;
            z-index: -1;
        }

        .particle {
            position: absolute;
            width: 2px;
            height: 2px;
            background: var(--accent-primary);
            border-radius: 50%;
            animation: float 15s infinite linear;
            opacity: 0.4;
        }

        @keyframes float {
            0% { transform: translateY(100vh) rotate(0deg); opacity: 0; }
            10% { opacity: 0.4; }
            90% { opacity: 0.4; }
            100% { transform: translateY(-100px) rotate(360deg); opacity: 0; }
        }

        @keyframes spin {
            from { transform: rotate(0deg); }
            to { transform: rotate(360deg); }
        }

        @keyframes slideIn {
            from { opacity: 0; transform: translateY(20px); }
            to { opacity: 1; transform: translateY(0); }
        }

        .container {
            max-width: 428px;
            margin: 0 auto;
            padding: 0 20px;
            position: relative;
        }

        /* Header */
        .header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            padding: 24px 0;
            border-bottom: 1px solid var(--border-subtle);
            position: sticky;
            top: 0;
            backdrop-filter: blur(20px);
            background: rgba(10, 10, 15, 0.9);
            z-index: 100;
        }

        .logo {
            font-size: 28px;
            font-weight: 700;
            background: linear-gradient(135deg, var(--accent-primary), var(--accent-secondary));
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
            cursor: pointer;
            transition: transform 0.3s ease;
        }

        .logo:hover {
            transform: scale(1.05);
        }

        .wallet-btn {
            background: linear-gradient(135deg, var(--accent-primary), var(--accent-secondary));
            border: none;
            padding: 12px 24px;
            border-radius: 16px;
            color: var(--text-primary);
            font-weight: 500;
            font-size: 14px;
            cursor: pointer;
            transition: all 0.3s ease;
            box-shadow: var(--shadow-md);
            position: relative;
        }

        .wallet-btn:hover {
            transform: translateY(-2px);
            box-shadow: var(--shadow-lg);
        }

        .wallet-btn.connected {
            background: var(--bg-card);
            border: 1px solid var(--border-primary);
            color: var(--accent-secondary);
        }

        .wallet-btn.loading::after {
            content: '';
            position: absolute;
            top: 50%;
            left: 50%;
            width: 16px;
            height: 16px;
            margin: -8px 0 0 -8px;
            border: 2px solid transparent;
            border-top: 2px solid currentColor;
            border-radius: 50%;
            animation: spin 1s linear infinite;
        }

        /* Navigation */
        .nav-tabs {
            display: flex;
            background: var(--bg-glass);
            border: 1px solid var(--border-subtle);
            border-radius: 20px;
            padding: 6px;
            margin: 24px 0;
            backdrop-filter: blur(20px);
        }

        .nav-tab {
            flex: 1;
            text-align: center;
            padding: 12px;
            border-radius: 14px;
            cursor: pointer;
            transition: all 0.3s ease;
            font-weight: 500;
            font-size: 14px;
            color: var(--text-muted);
        }

        .nav-tab.active {
            background: linear-gradient(135deg, var(--accent-primary), var(--accent-secondary));
            color: var(--text-primary);
            box-shadow: var(--shadow-md);
        }

        .nav-tab:hover:not(.active) {
            color: var(--text-secondary);
            background: var(--bg-hover);
        }

        /* Content Sections */
        .content-section {
            display: none;
            animation: slideIn 0.4s ease;
            padding-bottom: 120px;
        }

        .content-section.active {
            display: block;
        }

        /* Portfolio Header */
        .portfolio-header {
            background: linear-gradient(135deg, 
                rgba(139, 92, 246, 0.15) 0%, 
                rgba(99, 102, 241, 0.15) 50%, 
                rgba(6, 182, 212, 0.15) 100%);
            border: 1px solid var(--border-primary);
            border-radius: 24px;
            padding: 32px 24px;
            margin: 24px 0;
            text-align: center;
            backdrop-filter: blur(20px);
        }

        .portfolio-value {
            font-size: 36px;
            font-weight: 700;
            margin-bottom: 8px;
            background: linear-gradient(135deg, var(--text-primary), var(--accent-secondary));
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
        }

        .portfolio-change {
            font-size: 16px;
            font-weight: 500;
            display: flex;
            align-items: center;
            justify-content: center;
            gap: 12px;
        }

        .portfolio-change.positive { color: var(--success); }
        .portfolio-change.negative { color: var(--error); }

        /* Chart */
        .chart-container {
            background: var(--bg-glass);
            border: 1px solid var(--border-subtle);
            border-radius: 24px;
            padding: 24px;
            margin: 24px 0;
            height: 320px;
            backdrop-filter: blur(20px);
        }

        .chart-controls {
            display: flex;
            justify-content: center;
            gap: 8px;
            margin-bottom: 20px;
        }

        .chart-btn {
            padding: 8px 16px;
            border-radius: 12px;
            border: 1px solid var(--border-subtle);
            background: transparent;
            color: var(--text-muted);
            cursor: pointer;
            transition: all 0.3s ease;
            font-size: 13px;
            font-weight: 500;
        }

        .chart-btn:hover {
            background: var(--bg-hover);
            color: var(--text-secondary);
        }

        .chart-btn.active {
            background: linear-gradient(135deg, var(--accent-primary), var(--accent-secondary));
            border-color: var(--accent-primary);
            color: var(--text-primary);
        }

        /* Cards */
        .card {
            background: var(--bg-glass);
            border: 1px solid var(--border-subtle);
            border-radius: 20px;
            backdrop-filter: blur(20px);
            transition: all 0.3s ease;
            margin-bottom: 16px;
        }

        .card:hover {
            transform: translateY(-2px);
            box-shadow: var(--shadow-lg);
            border-color: var(--border-primary);
        }

        /* Token List */
        .token-item {
            background: var(--bg-glass);
            border: 1px solid var(--border-subtle);
            border-radius: 16px;
            padding: 20px;
            display: flex;
            align-items: center;
            justify-content: space-between;
            backdrop-filter: blur(20px);
            transition: all 0.3s ease;
            margin-bottom: 12px;
            cursor: pointer;
        }

        .token-item:hover {
            background: var(--bg-hover);
            border-color: var(--border-primary);
            transform: translateY(-2px);
        }

        .token-info {
            display: flex;
            align-items: center;
            gap: 16px;
        }

        .token-icon {
            width: 48px;
            height: 48px;
            border-radius: 12px;
            background: linear-gradient(135deg, var(--accent-primary), var(--accent-secondary));
            display: flex;
            align-items: center;
            justify-content: center;
            font-weight: 600;
            font-size: 16px;
            color: var(--text-primary);
        }

        .token-details h3 {
            font-size: 16px;
            font-weight: 500;
            margin-bottom: 4px;
            color: var(--text-primary);
        }

        .token-details p {
            font-size: 13px;
            color: var(--text-muted);
        }

        .token-stats {
            text-align: right;
        }

        .token-price {
            font-size: 16px;
            font-weight: 600;
            margin-bottom: 4px;
            color: var(--text-primary);
        }

        .token-change {
            font-size: 13px;
            font-weight: 500;
            padding: 4px 8px;
            border-radius: 6px;
        }

        .token-change.positive {
            color: var(--success);
            background: rgba(16, 185, 129, 0.1);
        }

        .token-change.negative {
            color: var(--error);
            background: rgba(239, 68, 68, 0.1);
        }

        /* Section Titles */
        .section-title {
            font-size: 20px;
            font-weight: 600;
            margin-bottom: 20px;
            display: flex;
            align-items: center;
            gap: 12px;
            color: var(--text-primary);
        }

        /* Forms */
        .form-container {
            background: var(--bg-glass);
            border: 1px solid var(--border-subtle);
            border-radius: 20px;
            padding: 24px;
            margin: 24px 0;
            backdrop-filter: blur(20px);
        }

        .form-group {
            margin-bottom: 20px;
        }

        .form-label {
            display: block;
            margin-bottom: 8px;
            font-size: 14px;
            font-weight: 500;
            color: var(--text-secondary);
        }

        .form-input, .form-select {
            width: 100%;
            padding: 14px 16px;
            border-radius: 12px;
            border: 1px solid var(--border-subtle);
            background: var(--bg-card);
            color: var(--text-primary);
            font-size: 14px;
            transition: all 0.3s ease;
        }

        .form-input:focus, .form-select:focus {
            outline: none;
            border-color: var(--accent-primary);
            box-shadow: 0 0 0 3px rgba(99, 102, 241, 0.1);
        }

        .form-input::placeholder {
            color: var(--text-muted);
        }

        .submit-btn {
            width: 100%;
            background: linear-gradient(135deg, var(--accent-primary), var(--accent-secondary));
            border: none;
            padding: 14px;
            border-radius: 12px;
            color: var(--text-primary);
            font-weight: 500;
            font-size: 16px;
            cursor: pointer;
            transition: all 0.3s ease;
        }

        .submit-btn:hover {
            transform: translateY(-2px);
            box-shadow: var(--shadow-lg);
        }

        .submit-btn:disabled {
            opacity: 0.6;
            cursor: not-allowed;
            transform: none;
        }

        /* Trader Cards */
        .trader-card {
            background: var(--bg-glass);
            border: 1px solid var(--border-subtle);
            border-radius: 16px;
            padding: 20px;
            margin-bottom: 16px;
            backdrop-filter: blur(20px);
            transition: all 0.3s ease;
        }

        .trader-card:hover {
            border-color: var(--border-primary);
            transform: translateY(-2px);
        }

        .trader-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 16px;
        }

        .trader-info {
            display: flex;
            align-items: center;
            gap: 12px;
        }

        .trader-avatar {
            width: 40px;
            height: 40px;
            border-radius: 10px;
            background: linear-gradient(135deg, var(--accent-pink), var(--warning));
            display: flex;
            align-items: center;
            justify-content: center;
            font-weight: 600;
            font-size: 14px;
            color: var(--text-primary);
        }

        .trader-info div h3 {
            font-size: 15px;
            font-weight: 500;
            margin-bottom: 4px;
            color: var(--text-primary);
        }

        .trader-info div p {
            font-size: 12px;
            color: var(--text-muted);
        }

        .follow-btn {
            background: linear-gradient(135deg, var(--accent-tertiary), var(--accent-primary));
            border: none;
            color: var(--text-primary);
            padding: 8px 16px;
            border-radius: 8px;
            cursor: pointer;
            font-size: 12px;
            font-weight: 500;
            transition: all 0.3s ease;
        }

        .follow-btn:hover {
            transform: translateY(-1px);
        }

        .follow-btn.following {
            background: var(--bg-card);
            border: 1px solid var(--success);
            color: var(--success);
        }

        .trader-stats {
            display: grid;
            grid-template-columns: 1fr 1fr 1fr;
            gap: 12px;
        }

        .stat-item {
            text-align: center;
            padding: 12px;
            background: rgba(30, 30, 42, 0.5);
            border-radius: 8px;
            border: 1px solid var(--border-subtle);
        }

        .stat-value {
            font-size: 16px;
            font-weight: 600;
            color: var(--success);
            margin-bottom: 4px;
        }

        .stat-item div:last-child {
            color: var(--text-muted);
            font-size: 11px;
        }

        /* Loading */
        .loading {
            display: flex;
            justify-content: center;
            align-items: center;
            padding: 40px;
        }

        .spinner {
            width: 40px;
            height: 40px;
            border: 3px solid var(--border-subtle);
            border-top: 3px solid var(--accent-primary);
            border-radius: 50%;
            animation: spin 1s linear infinite;
        }

        /* Empty States */
        .empty-state {
            text-align: center;
            padding: 40px 20px;
            color: var(--text-muted);
        }

        .empty-state-icon {
            font-size: 48px;
            margin-bottom: 16px;
            opacity: 0.5;
        }

        .empty-state h3 {
            font-size: 18px;
            font-weight: 500;
            margin-bottom: 8px;
            color: var(--text-secondary);
        }

        .empty-state p {
            font-size: 14px;
        }

        /* Bottom Navigation */
        .bottom-nav {
            position: fixed;
            bottom: 0;
            left: 50%;
            transform: translateX(-50%);
            width: 100%;
            max-width: 428px;
            background: rgba(10, 10, 15, 0.95);
            backdrop-filter: blur(30px);
            border-top: 1px solid var(--border-subtle);
            padding: 16px 20px 24px;
            z-index: 1000;
        }

        .nav-items {
            display: flex;
            justify-content: space-around;
            align-items: center;
        }

        .nav-item {
            display: flex;
            flex-direction: column;
            align-items: center;
            gap: 4px;
            cursor: pointer;
            padding: 8px;
            border-radius: 12px;
            transition: all 0.3s ease;
            color: var(--text-muted);
            min-width: 60px;
        }

        .nav-item.active {
            color: var(--accent-primary);
            background: rgba(99, 102, 241, 0.1);
        }

        .nav-item:hover:not(.active) {
            color: var(--text-secondary);
            background: var(--bg-hover);
        }

        .nav-icon {
            font-size: 20px;
        }

        .nav-label {
            font-size: 10px;
            font-weight: 500;
        }

        /* Notifications */
        .notification {
            position: fixed;
            top: 20px;
            right: 20px;
            background: var(--bg-glass);
            border: 1px solid var(--border-primary);
            color: var(--text-primary);
            padding: 16px 20px;
            border-radius: 12px;
            font-size: 14px;
            font-weight: 500;
            z-index: 1001;
            transform: translateX(100%);
            transition: all 0.4s ease;
            backdrop-filter: blur(20px);
            max-width: 300px;
        }

        .notification.show {
            transform: translateX(0);
        }

        .notification.success {
            border-color: var(--success);
            background: linear-gradient(135deg, rgba(16, 185, 129, 0.1), var(--bg-glass));
        }

        .notification.error {
            border-color: var(--error);
            background: linear-gradient(135deg, rgba(239, 68, 68, 0.1), var(--bg-glass));
        }

        .notification.info {
            border-color: var(--accent-tertiary);
            background: linear-gradient(135deg, rgba(6, 182, 212, 0.1), var(--bg-glass));
        }

        /* Responsive */
        @media (max-width: 480px) {
            .container {
                padding: 0 16px;
            }
            
            .portfolio-value {
                font-size: 32px;
            }

            .notification {
                right: 16px;
                left: 16px;
                max-width: none;
            }
        }
    </style>
</head>
<body>
    <div class="bg-particles" id="bgParticles"></div>

    <div class="container">
        <header class="header">
            <div class="logo" onclick="refreshApp()">Cypher</div>
            <button class="wallet-btn" id="walletBtn">Connect Wallet</button>
        </header>

        <div class="nav-tabs">
            <div class="nav-tab active" data-section="portfolio">Portfolio</div>
            <div class="nav-tab" data-section="social">Social</div>
            <div class="nav-tab" data-section="alerts">Alerts</div>
            <div class="nav-tab" data-section="analytics">Analytics</div>
        </div>

        <main>
            <!-- Portfolio Section -->
            <section class="content-section active" id="portfolio">
                <div class="portfolio-header">
                    <div class="portfolio-value" id="portfolioValue">$0.00</div>
                    <div class="portfolio-change" id="portfolioChange">
                        <span>+$0.00 (0.00%)</span>
                        <span>24h</span>
                    </div>
                </div>

                <div class="chart-container">
                    <div class="chart-controls">
                        <button class="chart-btn active" data-period="1D">1D</button>
                        <button class="chart-btn" data-period="1W">1W</button>
                        <button class="chart-btn" data-period="1M">1M</button>
                        <button class="chart-btn" data-period="1Y">1Y</button>
                    </div>
                    <canvas id="portfolioChart"></canvas>
                </div>

                <div id="tokenList">
                    <div class="loading">
                        <div class="spinner"></div>
                    </div>
                </div>
            </section>

            <!-- Social Section -->
            <section class="content-section" id="social">
                <h2 class="section-title">🏆 Top Performers</h2>
                <div id="topTradersList">
                    <div class="loading">
                        <div class="spinner"></div>
                    </div>
                </div>

                <h2 class="section-title">📋 Copy Trading</h2>
                <div class="form-container">
                    <div class="form-group">
                        <label class="form-label">Target Trader Wallet</label>
                        <input type="text" class="form-input" id="targetTrader" placeholder="Enter wallet address">
                    </div>
                    <div class="form-group">
                        <label class="form-label">Allocation Amount (SOL)</label>
                        <input type="number" class="form-input" id="allocationAmount" placeholder="0.1 - 5.0" min="0.1" max="5.0" step="0.1">
                    </div>
                    <div class="form-group">
                        <label class="form-label">Max Slippage (%)</label>
                        <input type="number" class="form-input" id="maxSlippage" placeholder="1-10" min="1" max="10" value="5">
                    </div>
                    <button class="submit-btn" id="copyTradeBtn">Start Copy Trading</button>
                </div>
            </section>

            <!-- Alerts Section -->
            <section class="content-section" id="alerts">
                <h2 class="section-title">🔔 Create Alert</h2>
                <div class="form-container">
                    <div class="form-group">
                        <label class="form-label">Token</label>
                        <select class="form-select" id="alertToken">
                            <option value="">Select token</option>
                        </select>
                    </div>
                    <div class="form-group">
                        <label class="form-label">Target Price ($)</label>
                        <input type="number" class="form-input" id="targetPrice" placeholder="0.00" step="0.01">
                    </div>
                    <div class="form-group">
                        <label class="form-label">Alert Direction</label>
                        <select class="form-select" id="alertDirection">
                            <option value="above">Above target</option>
                            <option value="below">Below target</option>
                        </select>
                    </div>
                    <button class="submit-btn" id="createAlertBtn">Create Alert</button>
                </div>

                <h2 class="section-title">📋 Active Alerts</h2>
                <div id="alertsList">
                    <div class="loading">
                        <div class="spinner"></div>
                    </div>
                </div>
            </section>

            <!-- Analytics Section -->
            <section class="content-section" id="analytics">
                <h2 class="section-title">📊 Analytics</h2>
                <div class="card" style="padding: 24px; text-align: center;">
                    <h3 style="margin-bottom: 16px;">Coming Soon</h3>
                    <p style="color: var(--text-muted);">Advanced analytics and risk monitoring features will be available soon.</p>
                </div>
            </section>
        </main>

        <nav class="bottom-nav">
            <div class="nav-items">
                <div class="nav-item active" data-section="portfolio">
                    <div class="nav-icon">📊</div>
                    <div class="nav-label">Portfolio</div>
                </div>
                <div class="nav-item" data-section="social">
                    <div class="nav-icon">👥</div>
                    <div class="nav-label">Social</div>
                </div>
                <div class="nav-item" data-section="alerts">
                    <div class="nav-icon">🔔</div>
                    <div class="nav-label">Alerts</div>
                </div>
                <div class="nav-item" data-section="analytics">
                    <div class="nav-icon">📈</div>
                    <div class="nav-label">Analytics</div>
                </div>
            </div>
        </nav>
    </div>

    <div class="notification" id="notification"></div>

    <script>
        // Global State
        let walletConnected = false;
        let walletAddress = null;
        let portfolioChart = null;
        let userTokens = [];
        let followedTraders = new Set();
        let activeAlerts = [];
        let portfolioData = { totalValue: 0, change24h: 0, changePercent: 0 };

        // API URLs
        const COINGECKO_API = 'https://api.coingecko.com/api/v3';

        // Initialize App
        document.addEventListener('DOMContentLoaded', function() {
            console.log('🚀 Initializing Cypher dApp...');
            initializeApp();
            setupEventListeners();
            createBackgroundParticles();
        });

        function initializeApp() {
            loadPortfolioData();
            loadTopTraders();
            loadTokenOptions();
            setupChart();
            loadActiveAlerts();
        }

        function setupEventListeners() {
            // Wallet button
            document.getElementById('walletBtn').addEventListener('click', handleWalletClick);

            // Navigation
            document.querySelectorAll('.nav-item, .nav-tab').forEach(item => {
                item.addEventListener('click', function() {
                    switchSection(this.dataset.section);
                });
            });

            // Chart controls
            document.querySelectorAll('.chart-btn').forEach(btn => {
                btn.addEventListener('click', function() {
                    document.querySelectorAll('.chart-btn').forEach(b => b.classList.remove('active'));
                    this.classList.add('active');
                    updateChart(this.dataset.period);
                });
            });

            // Form buttons
            document.getElementById('copyTradeBtn').addEventListener('click', handleCopyTrade);
            document.getElementById('createAlertBtn').addEventListener('click', handleCreateAlert);
        }

        // Background Particles
        function createBackgroundParticles() {
            const container = document.getElementById('bgParticles');
            
            function createParticle() {
                const particle = document.createElement('div');
                particle.className = 'particle';
                particle.style.left = Math.random() * 100 + '%';
                particle.style.animationDuration = (Math.random() * 10 + 10) + 's';
                particle.style.animationDelay = Math.random() * 2 + 's';
                container.appendChild(particle);

                setTimeout(() => {
                    if (particle.parentNode) {
                        particle.parentNode.removeChild(particle);
                    }
                }, 20000);
            }

            // Create initial particles
            for (let i = 0; i < 10; i++) {
                setTimeout(createParticle, i * 500);
            }

            // Continue creating particles
            setInterval(createParticle, 2000);
        }

        // Wallet Functions
        async function handleWalletClick() {
            const walletBtn = document.getElementById('walletBtn');

            if (walletConnected) {
                // Disconnect wallet
                walletConnected = false;
                walletAddress = null;
                walletBtn.textContent = 'Connect Wallet';
                walletBtn.classList.remove('connected');
                showNotification('Wallet disconnected', 'info');
                return;
            }

            try {
                walletBtn.classList.add('loading');
                walletBtn.textContent = '';

                // Check if Phantom wallet is available
                if (typeof window.solana === 'undefined') {
                    throw new Error('Please install Phantom wallet');
                }

                const wallet = window.solana;
                const response = await wallet.connect();
                walletAddress = response.publicKey.toString();
                walletConnected = true;

                walletBtn.classList.remove('loading');
                walletBtn.textContent = walletAddress.slice(0, 4) + '...' + walletAddress.slice(-4);
                walletBtn.classList.add('connected');

                showNotification('Wallet connected successfully!', 'success');
                loadPortfolioData();

            } catch (error) {
                console.error('Wallet connection failed:', error);
                walletBtn.classList.remove('loading');
                walletBtn.textContent = 'Connect Wallet';
                showNotification(error.message || 'Failed to connect wallet', 'error');
            }
        }

        // Portfolio Functions
        async function loadPortfolioData() {
            try {
                // Fetch Solana ecosystem tokens from CoinGecko
                const response = await fetch(`${COINGECKO_API}/coins/markets?vs_currency=usd&category=solana-ecosystem&order=market_cap_desc&per_page=10&page=1`);
                const tokens = await response.json();

                // Simulate user portfolio
                userTokens = tokens.slice(0, 6).map(token => ({
                    symbol: token.symbol.toUpperCase(),
                    name: token.name,
                    price: token.current_price,
                    change24h: token.price_change_percentage_24h || 0,
                    balance: (Math.random() * 100 + 10).toFixed(2),
                    value: token.current_price * (Math.random() * 100 + 10)
                }));

                portfolioData.totalValue = userTokens.reduce((sum, token) => sum + token.value, 0);
                portfolioData.change24h = portfolioData.totalValue * (Math.random() * 0.1 - 0.05);
                portfolioData.changePercent = (portfolioData.change24h / portfolioData.totalValue) * 100;

                updatePortfolioDisplay();

            } catch (error) {
                console.error('Failed to load portfolio:', error);
                showNotification('Failed to load portfolio data', 'error');
            }
        }

        function updatePortfolioDisplay() {
            // Update portfolio value
            document.getElementById('portfolioValue').textContent = 
                `${portfolioData.totalValue.toLocaleString('en-US', { minimumFractionDigits: 2, maximumFractionDigits: 2 })}`;

            // Update portfolio change
            const changeElement = document.getElementById('portfolioChange');
            const changeSign = portfolioData.change24h >= 0 ? '+' : '';
            const changeClass = portfolioData.change24h >= 0 ? 'positive' : 'negative';

            changeElement.innerHTML = `
                <span>${changeSign}${Math.abs(portfolioData.change24h).toLocaleString('en-US', { minimumFractionDigits: 2, maximumFractionDigits: 2 })} (${changeSign}${Math.abs(portfolioData.changePercent).toFixed(2)}%)</span>
                <span>24h</span>
            `;
            changeElement.className = `portfolio-change ${changeClass}`;

            // Update token list
            updateTokenList();
        }

        function updateTokenList() {
            const tokenList = document.getElementById('tokenList');

            if (userTokens.length === 0) {
                tokenList.innerHTML = `
                    <div class="empty-state">
                        <div class="empty-state-icon">💼</div>
                        <h3>No tokens found</h3>
                        <p>Connect your wallet to view your portfolio</p>
                    </div>
                `;
                return;
            }

            tokenList.innerHTML = userTokens.map((token, index) => `
                <div class="token-item" onclick="showTokenDetails('${token.symbol}')" style="animation-delay: ${index * 0.1}s">
                    <div class="token-info">
                        <div class="token-icon">
                            ${token.symbol.charAt(0)}
                        </div>
                        <div class="token-details">
                            <h3>${token.symbol}</h3>
                            <p>${token.balance} tokens</p>
                        </div>
                    </div>
                    <div class="token-stats">
                        <div class="token-price">${token.price.toFixed(4)}</div>
                        <div class="token-change ${token.change24h >= 0 ? 'positive' : 'negative'}">
                            ${token.change24h >= 0 ? '+' : ''}${token.change24h.toFixed(2)}%
                        </div>
                    </div>
                </div>
            `).join('');
        }

        function showTokenDetails(symbol) {
            const token = userTokens.find(t => t.symbol === symbol);
            if (token) {
                showNotification(`${token.symbol}: ${token.value.toFixed(2)} USD value`, 'info');
            }
        }

        // Chart Functions
        function setupChart() {
            const ctx = document.getElementById('portfolioChart').getContext('2d');
            const chartData = generateChartData('1D');

            portfolioChart = new Chart(ctx, {
                type: 'line',
                data: {
                    labels: chartData.labels,
                    datasets: [{
                        label: 'Portfolio Value',
                        data: chartData.values,
                        borderColor: '#6366F1',
                        backgroundColor: 'rgba(99, 102, 241, 0.1)',
                        borderWidth: 3,
                        fill: true,
                        tension: 0.4,
                        pointRadius: 0,
                        pointHoverRadius: 6,
                        pointBackgroundColor: '#6366F1',
                        pointBorderColor: '#ffffff',
                        pointBorderWidth: 2
                    }]
                },
                options: {
                    responsive: true,
                    maintainAspectRatio: false,
                    plugins: {
                        legend: { display: false }
                    },
                    scales: {
                        x: {
                            display: true,
                            grid: { color: 'rgba(248, 250, 252, 0.1)' },
                            ticks: { color: '#64748B', font: { size: 11 } }
                        },
                        y: {
                            display: true,
                            grid: { color: 'rgba(248, 250, 252, 0.1)' },
                            ticks: {
                                color: '#64748B',
                                font: { size: 11 },
                                callback: function(value) {
                                    return ' + value.toLocaleString();
                                }
                            }
                        }
                    },
                    interaction: {
                        intersect: false,
                        mode: 'index'
                    }
                }
            });
        }

        function generateChartData(period) {
            const periods = {
                '1D': { points: 24, interval: 'hour' },
                '1W': { points: 7, interval: 'day' },
                '1M': { points: 30, interval: 'day' },
                '1Y': { points: 12, interval: 'month' }
            };

            const config = periods[period];
            const labels = [];
            const values = [];
            const baseValue = portfolioData.totalValue || 10000;

            for (let i = config.points - 1; i >= 0; i--) {
                const date = new Date();
                if (config.interval === 'hour') {
                    date.setHours(date.getHours() - i);
                    labels.push(date.toLocaleTimeString('en-US', { hour: '2-digit', minute: '2-digit' }));
                } else if (config.interval === 'day') {
                    date.setDate(date.getDate() - i);
                    labels.push(date.toLocaleDateString('en-US', { month: 'short', day: 'numeric' }));
                } else {
                    date.setMonth(date.getMonth() - i);
                    labels.push(date.toLocaleDateString('en-US', { month: 'short', year: '2-digit' }));
                }

                const volatility = 0.02;
                const randomChange = (Math.random() - 0.5) * volatility;
                const value = baseValue * (1 + randomChange);
                values.push(Math.round(value));
            }

            return { labels, values };
        }

        function updateChart(period) {
            if (!portfolioChart) return;

            const chartData = generateChartData(period);
            portfolioChart.data.labels = chartData.labels;
            portfolioChart.data.datasets[0].data = chartData.values;
            portfolioChart.update('none');
        }

        // Social Functions
        async function loadTopTraders() {
            try {
                const traders = [
                    {
                        address: '7xKXtg2CW87d97TXJSDpbD5jBkheTqA83TZRaJFD5Z1n',
                        username: 'CryptoWhale',
                        pnl: '+$45,230',
                        winRate: '78%',
                        followers: 1247,
                        avatar: 'CW'
                    },
                    {
                        address: '9WzDXwBbmkg8ZTbNMqUxvQRAyrZzDsGYdLVL9zYtAWWM',
                        username: 'SolanaSniper',
                        pnl: '+$32,180',
                        winRate: '65%',
                        followers: 892,
                        avatar: 'SS'
                    },
                    {
                        address: '3Jw1kXz4KvQgAC8hg4K5YPmYqNQ8h4GWTFdZsKz9LMNn',
                        username: 'DiamondHands',
                        pnl: '+$28,945',
                        winRate: '72%',
                        followers: 654,
                        avatar: 'DH'
                    }
                ];

                const tradersList = document.getElementById('topTradersList');
                tradersList.innerHTML = traders.map(trader => `
                    <div class="trader-card">
                        <div class="trader-header">
                            <div class="trader-info">
                                <div class="trader-avatar">${trader.avatar}</div>
                                <div>
                                    <h3>${trader.username}</h3>
                                    <p>${trader.address.slice(0, 8)}...${trader.address.slice(-4)}</p>
                                </div>
                            </div>
                            <button class="follow-btn ${followedTraders.has(trader.address) ? 'following' : ''}" 
                                    onclick="followTrader('${trader.address}', this)">
                                ${followedTraders.has(trader.address) ? 'Following' : 'Follow'}
                            </button>
                        </div>
                        <div class="trader-stats">
                            <div class="stat-item">
                                <div class="stat-value">${trader.pnl}</div>
                                <div>P&L</div>
                            </div>
                            <div class="stat-item">
                                <div class="stat-value">${trader.winRate}</div>
                                <div>Win Rate</div>
                            </div>
                            <div class="stat-item">
                                <div class="stat-value">${trader.followers}</div>
                                <div>Followers</div>
                            </div>
                        </div>
                    </div>
                `).join('');

            } catch (error) {
                console.error('Failed to load traders:', error);
            }
        }

        function followTrader(traderAddress, button) {
            if (!walletConnected) {
                showNotification('Please connect your wallet first', 'error');
                return;
            }

            try {
                if (followedTraders.has(traderAddress)) {
                    followedTraders.delete(traderAddress);
                    button.textContent = 'Follow';
                    button.classList.remove('following');
                    showNotification('Unfollowed trader', 'info');
                } else {
                    followedTraders.add(traderAddress);
                    button.textContent = 'Following';
                    button.classList.add('following');
                    showNotification('Now following trader!', 'success');
                }
            } catch (error) {
                console.error('Failed to follow trader:', error);
                showNotification('Failed to follow trader', 'error');
            }
        }

        // Copy Trading
        async function handleCopyTrade() {
            if (!walletConnected) {
                showNotification('Please connect your wallet first', 'error');
                return;
            }

            const targetTrader = document.getElementById('targetTrader').value.trim();
            const allocationAmount = document.getElementById('allocationAmount').value;
            const maxSlippage = document.getElementById('maxSlippage').value;
            const button = document.getElementById('copyTradeBtn');

            if (!targetTrader || !allocationAmount) {
                showNotification('Please fill in all required fields', 'error');
                return;
            }

            if (parseFloat(allocationAmount) < 0.1 || parseFloat(allocationAmount) > 5.0) {
                showNotification('Allocation amount must be between 0.1 and 5.0 SOL', 'error');
                return;
            }

            try {
                button.disabled = true;
                button.textContent = 'Setting up...';

                // Simulate API call
                await new Promise(resolve => setTimeout(resolve, 2000));

                showNotification('Copy trade setup successfully!', 'success');

                // Reset form
                document.getElementById('targetTrader').value = '';
                document.getElementById('allocationAmount').value = '';
                document.getElementById('maxSlippage').value = '5';

            } catch (error) {
                console.error('Failed to create copy trade:', error);
                showNotification('Failed to setup copy trade', 'error');
            } finally {
                button.disabled = false;
                button.textContent = 'Start Copy Trading';
            }
        }

        // Alert Functions
        async function loadTokenOptions() {
            try {
                const response = await fetch(`${COINGECKO_API}/coins/markets?vs_currency=usd&category=solana-ecosystem&order=market_cap_desc&per_page=20&page=1`);
                const tokens = await response.json();

                const selectElement = document.getElementById('alertToken');
                selectElement.innerHTML = '<option value="">Select token</option>' +
                    tokens.map(token => `<option value="${token.symbol.toUpperCase()}">${token.symbol.toUpperCase()} - ${token.name}</option>`).join('');

            } catch (error) {
                console.error('Failed to load token options:', error);
            }
        }

        async function handleCreateAlert() {
            if (!walletConnected) {
                showNotification('Please connect your wallet first', 'error');
                return;
            }

            const token = document.getElementById('alertToken').value;
            const price = document.getElementById('targetPrice').value;
            const direction = document.getElementById('alertDirection').value;
            const button = document.getElementById('createAlertBtn');

            if (!token || !price) {
                showNotification('Please fill in all fields', 'error');
                return;
            }

            try {
                button.disabled = true;
                button.textContent = 'Creating...';

                // Simulate API call
                await new Promise(resolve => setTimeout(resolve, 1000));

                const newAlert = {
                    id: Date.now(),
                    token,
                    target: `${parseFloat(price).toFixed(2)}`,
                    direction,
                    created: 'Just now'
                };
                activeAlerts.push(newAlert);

                showNotification('Alert created successfully!', 'success');

                // Reset form
                document.getElementById('alertToken').value = '';
                document.getElementById('targetPrice').value = '';

                loadActiveAlerts();

            } catch (error) {
                console.error('Failed to create alert:', error);
                showNotification('Failed to create alert', 'error');
            } finally {
                button.disabled = false;
                button.textContent = 'Create Alert';
            }
        }

        function loadActiveAlerts() {
            const alertsList = document.getElementById('alertsList');

            if (activeAlerts.length === 0) {
                alertsList.innerHTML = `
                    <div class="empty-state">
                        <div class="empty-state-icon">🔔</div>
                        <h3>No active alerts</h3>
                        <p>Create price alerts to get notified</p>
                    </div>
                `;
                return;
            }

            alertsList.innerHTML = activeAlerts.map(alert => `
                <div class="card" style="padding: 16px; display: flex; justify-content: space-between; align-items: center;">
                    <div>
                        <h4>${alert.token} Alert</h4>
                        <p style="color: var(--text-muted); font-size: 13px;">${alert.direction} ${alert.target} • ${alert.created}</p>
                    </div>
                    <button onclick="deleteAlert(${alert.id})" style="background: rgba(239, 68, 68, 0.1); border: 1px solid var(--error); color: var(--error); padding: 6px 12px; border-radius: 6px; cursor: pointer; font-size: 12px;">
                        Delete
                    </button>
                </div>
            `).join('');
        }

        function deleteAlert(alertId) {
            activeAlerts = activeAlerts.filter(alert => alert.id !== alertId);
            loadActiveAlerts();
            showNotification('Alert deleted successfully!', 'success');
        }

        // Navigation
        function switchSection(sectionName) {
            // Update navigation states
            document.querySelectorAll('.nav-item, .nav-tab').forEach(item => {
                item.classList.remove('active');
            });
            document.querySelectorAll(`[data-section="${sectionName}"]`).forEach(item => {
                item.classList.add('active');
            });

            // Update content sections
            document.querySelectorAll('.content-section').forEach(section => {
                section.classList.remove('active');
            });
            document.getElementById(sectionName).classList.add('active');

            // Load section-specific data
            if (sectionName === 'alerts') {
                loadActiveAlerts();
            }
        }

        // Utility Functions
        function showNotification(message, type = 'info') {
            const notification = document.getElementById('notification');
            notification.textContent = message;
            notification.className = `notification show ${type}`;

            setTimeout(() => {
                notification.classList.remove('show');
            }, 3000);
        }

        function refreshApp() {
            showNotification('Refreshing data...', 'info');
            loadPortfolioData();
            loadTopTraders();
        }

        // Auto-refresh portfolio data
        setInterval(() => {
            if (walletConnected) {
                loadPortfolioData();
            }
        }, 30000);
    </script>
</body>
</html>